{"ast":null,"code":"import { Observable } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nexport class SseService {\n  constructor() {\n    this.events$ = this.fromEventSource(\"http://localhost:3000/events\");\n  }\n  fromEventSource(url) {\n    return new Observable(subscriber => {\n      debugger;\n      const sse = new EventSource(url);\n      sse.onmessage = e => subscriber.next(JSON.parse(e.data));\n      sse.onerror = e => subscriber.error(e);\n      return () => {\n        if (sse.readyState === 1) {\n          sse.close();\n        }\n      };\n    });\n  }\n  static #_ = this.ɵfac = function SseService_Factory(t) {\n    return new (t || SseService)();\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: SseService,\n    factory: SseService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["Observable","SseService","constructor","events$","fromEventSource","url","subscriber","sse","EventSource","onmessage","e","next","JSON","parse","data","onerror","error","readyState","close","_","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\tmart\\Desktop\\Dissertacao\\SatoreApp\\angular\\src\\app\\services\\sse-services\\sse-services.ts"],"sourcesContent":["import {Injectable, OnDestroy, OnInit} from '@angular/core';\r\nimport {fromEvent, Observable, Subject} from 'rxjs';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class SseService {\r\n  events$: Observable<any> = this.fromEventSource(\"http://localhost:3000/events\");\r\n\r\n  fromEventSource(url: string): Observable<MessageEvent> {\r\n    return new Observable<MessageEvent>(subscriber => {\r\n      debugger;\r\n      const sse = new EventSource(url);\r\n\r\n      sse.onmessage = e => subscriber.next(JSON.parse(e.data));\r\n      sse.onerror = e => subscriber.error(e);\r\n\r\n      return () => {\r\n        if (sse.readyState === 1) {\r\n          sse.close();\r\n        }\r\n      };\r\n    });\r\n  }\r\n}\r\n"],"mappings":"AACA,SAAmBA,UAAU,QAAgB,MAAM;;AAKnD,OAAM,MAAOC,UAAU;EAHvBC,YAAA;IAIE,KAAAC,OAAO,GAAoB,IAAI,CAACC,eAAe,CAAC,8BAA8B,CAAC;;EAE/EA,eAAeA,CAACC,GAAW;IACzB,OAAO,IAAIL,UAAU,CAAeM,UAAU,IAAG;MAC/C;MACA,MAAMC,GAAG,GAAG,IAAIC,WAAW,CAACH,GAAG,CAAC;MAEhCE,GAAG,CAACE,SAAS,GAAGC,CAAC,IAAIJ,UAAU,CAACK,IAAI,CAACC,IAAI,CAACC,KAAK,CAACH,CAAC,CAACI,IAAI,CAAC,CAAC;MACxDP,GAAG,CAACQ,OAAO,GAAGL,CAAC,IAAIJ,UAAU,CAACU,KAAK,CAACN,CAAC,CAAC;MAEtC,OAAO,MAAK;QACV,IAAIH,GAAG,CAACU,UAAU,KAAK,CAAC,EAAE;UACxBV,GAAG,CAACW,KAAK,EAAE;;MAEf,CAAC;IACH,CAAC,CAAC;EACJ;EAAC,QAAAC,CAAA,G;qBAjBUlB,UAAU;EAAA;EAAA,QAAAmB,EAAA,G;WAAVnB,UAAU;IAAAoB,OAAA,EAAVpB,UAAU,CAAAqB,IAAA;IAAAC,UAAA,EAFT;EAAM","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}